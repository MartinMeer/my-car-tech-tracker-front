---
import Layout from '../layouts/Layout.astro';
---

<Layout title="–ü—Ä–æ–±–ª–µ–º—ã ‚Äî My Car Tech Tracker">
  <section>
    <h1>–£ –Ω–∞—Å –ø—Ä–æ–±–ª–µ–º—ã!</h1>
    
    <div class="alert-list-container">
      <div class="alert-list-header">
        <div class="alert-list-controls">
          <div class="add-alert-btn-container">
            <button id="new-alert-btn" class="btn btn-primary">
              <span class="icon">üö®</span>
              –°–æ–æ–±—â–∏—Ç—å –æ –ø—Ä–æ–±–ª–µ–º–µ
            </button>
          </div>
          <div class="archive-controls">
            <button id="view-archive-btn" class="btn btn-secondary">
              <span class="icon">üóÑÔ∏è</span>
              –ê—Ä—Ö–∏–≤
            </button>
          </div>
        </div>
      </div>
      
      <div class="alert-list-content" id="alert-list-content">
        <p class="page-description">–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º –ø–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º</p>
        <!-- Alerts will be loaded here dynamically -->
      </div>
      
      <div class="alert-list-empty" id="alert-list-empty" style="display: none;">
        <div class="empty-state">
          <div class="empty-icon">‚úÖ</div>
          <h3>–ü—Ä–æ–±–ª–µ–º –Ω–µ—Ç!</h3>
          <p>–í—Å–µ –≤–∞—à–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ –≤ –æ—Ç–ª–∏—á–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏</p>
          <button class="btn-primary" onclick="window.location.hash='#user-alert'">
            <span class="icon">üö®</span>
            –°–æ–æ–±—â–∏—Ç—å –æ –ø—Ä–æ–±–ª–µ–º–µ
          </button>
        </div>
      </div>
      
      <!-- Archive View -->
      <div class="archive-view" id="archive-view" style="display: none;">
        <div class="archive-header">
          <h2>–ê—Ä—Ö–∏–≤ –ø—Ä–æ–±–ª–µ–º</h2>
          <button id="back-to-alerts-btn" class="btn btn-secondary">
            <span class="icon">‚Üê</span>
            –ù–∞–∑–∞–¥ –∫ –ø—Ä–æ–±–ª–µ–º–∞–º
          </button>
        </div>
        <div class="archive-content" id="archive-content">
          <!-- Archived alerts will be loaded here -->
        </div>
        <div class="archive-empty" id="archive-empty" style="display: none;">
          <div class="empty-state">
            <div class="empty-icon">üóÑÔ∏è</div>
            <h3>–ê—Ä—Ö–∏–≤ –ø—É—Å—Ç</h3>
            <p>–ù–µ—Ç –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º</p>
          </div>
        </div>
      </div>
    </div>
  </section>
</Layout>

<script type="module">
  import { initializeAlertListUI } from '/src/userAlertUI.js';
  
  document.addEventListener('DOMContentLoaded', function() {
    console.log('Alert list page loaded, initializing alert list UI...');
    try {
      initializeAlertListUI();
      console.log('Alert list UI initialized successfully');
    } catch (error) {
      console.error('Error initializing alert list UI:', error);
      // Fallback initialization
      initializeBasicAlertList();
    }
  });

  function initializeBasicAlertList() {
    console.log('Using fallback alert list handler');
    
    // Basic button handlers
    const newAlertBtn = document.getElementById('new-alert-btn');
    const viewArchiveBtn = document.getElementById('view-archive-btn');
    const backToAlertsBtn = document.getElementById('back-to-alerts-btn');
    
    if (newAlertBtn) {
      newAlertBtn.addEventListener('click', function() {
        window.location.href = '/user-alert';
      });
    }
    
    if (viewArchiveBtn) {
      viewArchiveBtn.addEventListener('click', function() {
        alert('–§—É–Ω–∫—Ü–∏—è –∞—Ä—Ö–∏–≤–∞ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø–æ–ª–Ω–æ–π –≤–µ—Ä—Å–∏–∏');
      });
    }
    
    if (backToAlertsBtn) {
      backToAlertsBtn.addEventListener('click', function() {
        alert('–§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ –ø—Ä–æ–±–ª–µ–º–∞–º –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø–æ–ª–Ω–æ–π –≤–µ—Ä—Å–∏–∏');
      });
    }
  }
</script> 