---
import Layout from '../../layouts/Layout.astro';
---

<Layout title="–ú–æ–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ ‚Äî My Car Tech Tracker">
  <section>
    <h1>–ú–æ–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</h1>
    <div id="cars-list">
      <!-- –°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
    </div>
    <div class="add-car-btn-container">
      <a href="/cars/add-car" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∞–≤—Ç–æ–º–æ–±–∏–ª—å</a>
    </div>
  </section>
</Layout>

<script type="module">
  import { initializeMyCarsUI } from '/src/carsUI.js';
  
  document.addEventListener('DOMContentLoaded', function() {
    console.log('My cars page loaded, initializing cars UI...');
    try {
      initializeMyCarsUI();
      console.log('Cars UI initialized successfully');
    } catch (error) {
      console.error('Error initializing cars UI:', error);
      // Fallback initialization
      initializeBasicCarsList();
    }
  });

  function initializeBasicCarsList() {
    console.log('Using fallback cars list handler');
    
    const carsList = document.getElementById('cars-list');
    if (!carsList) return;

    // Show loading state
    carsList.innerHTML = '<div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π...</div>';
    
    // Simulate loading cars data
    setTimeout(() => {
      // Mock cars data
      const mockCars = [
        {
          id: 1,
          name: '–ú–æ–π –∞–≤—Ç–æ–º–æ–±–∏–ª—å',
          brand: 'Toyota',
          model: 'Camry',
          year: 2020,
          mileage: 50000
        }
      ];
      
      if (mockCars.length === 0) {
        carsList.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">üöó</div>
            <h3>–ù–µ—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π</h3>
            <p>–î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –∞–≤—Ç–æ–º–æ–±–∏–ª—å</p>
          </div>
        `;
      } else {
        const carsHTML = mockCars.map(car => `
          <div class="car-item">
            <div class="car-info">
              <h3>${car.brand} ${car.model}</h3>
              <p>–ì–æ–¥: ${car.year}</p>
              <p>–ü—Ä–æ–±–µ–≥: ${car.mileage} –∫–º</p>
            </div>
            <div class="car-actions">
              <button class="btn btn-secondary" onclick="window.location.href='/cars/my-car-overview'">
                –û–±–∑–æ—Ä
              </button>
            </div>
          </div>
        `).join('');
        
        carsList.innerHTML = carsHTML;
      }
    }, 1000);
  }
</script> 